//if IE 8
    <html lang="en" class="ie8">
//if IE 9
    <html lang="en" class="ie9">
//if IE 10
    <html lang="en" class="ie10">
//[if !IE]><!
html(lang="en")
    //<![endif]
  head
    meta(http-equiv="X-UA-Compatible", content="IE=Edge")
    // meta tag compatability mode for IE
    

    // meta tags for facebook story
    meta(property="og:site_name", content="Time Travel" )
    meta(property="og:title",content="Time Travel — a time machine on the Internet!")
    meta(property="og:description", content="Time Travel is an amazing web app that takes you back in time to see photos of your search topics and interests. You can use it to explore historical events and see its evolution through time. Moreover with the power of the Leap Motion Controller, it enhances the user experience and lets you really feel like walking through a time space." )
    meta(property="og:image", content="https://fbcdn-sphotos-g-a.akamaihd.net/hphotos-ak-xpa1/t1.0-9/15659_757048561003687_6061947397829616847_n.png" )
    meta(property="og:type", content="website")
    meta(property="og:url", content="http://timetravel-gettyimages.jp")
    // end meta tags

    link(href='http://fonts.googleapis.com/css?family=Abel', rel='stylesheet', type='text/css')
    title Time Travel
    link(rel="stylesheet", href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css")

    //[if lte IE9 ]<!
    script(src="//cdnjs.cloudflare.com/ajax/libs/json3/3.3.2/json3.min.js")
    //<![endif]

    script(src="//cdnjs.cloudflare.com/ajax/libs/es5-shim/3.4.0/es5-shim.min.js")
    script(src="/public/js/typedarray.js")
    //[if gt IE 9]><!
    script(src="//cdnjs.cloudflare.com/ajax/libs/three.js/r67/three.js")
    script.
      var THREE = THREE || {};
    script(src="/public/js/tween.min.js")
    script(src="/public/js/threex/OrbitControls.js")
    script(src="/public/js/threex/KeyboardState.js")
    //<![endif]
    //[if gt IE 10]><!
    script(src="//js.leapmotion.com/leap-0.4.1.min.js")
    //<![endif]
    script(src="//cdnjs.cloudflare.com/ajax/libs/async/1.22/async.min.js")
    script(src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js")
    script(src="//cdnjs.cloudflare.com/ajax/libs/jquery.form/3.49/jquery.form.min.js")
    script(src="//code.jquery.com/ui/1.10.4/jquery-ui.js")
    script(src="/public/js/jquery.leanModal.min.js")
    script(src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.min.js")
    script(src="//cdnjs.cloudflare.com/ajax/libs/spin.js/2.0.1/spin.js")
    script.
      // attach trigger to all lean modals
      $(function(){
        $("a[rel*=leanModal]").leanModal({ top: 40, overlay : 0.4});
      });
    script.
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-43653558-7', 'auto');
      ga('send', 'pageview');

    style.

      /* html5doctor.com Reset v1.6.1 (http://html5doctor.com/html-5-reset-stylesheet/) - http://cssreset.com */
      html,body,div,span,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,abbr,address,cite,code,del,dfn,em,img,ins,kbd,q,samp,small,strong,sub,sup,var,b,i,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,figcaption,figure,footer,header,hgroup,menu,nav,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}
      body{line-height:1}
      article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}
      nav ul{list-style:none}
      blockquote,q{quotes:none}
      blockquote:before,blockquote:after,q:before,q:after{content:none}
      a{margin:0;padding:0;font-size:100%;vertical-align:baseline;background:transparent}
      ins{background-color:#ff9;color:#000;text-decoration:none}
      mark{background-color:#ff9;color:#000;font-style:italic;font-weight:bold}
      del{text-decoration:line-through}
      abbr[title],dfn[title]{border-bottom:1px dotted;cursor:help}
      table{border-collapse:collapse;border-spacing:0}
      hr{display:block;height:1px;border:0;border-top:1px solid #ccc;margin:1em 0;padding:0}
      input,select{vertical-align:middle}
      /* end - html5doctor.com Reset v1.6.1 */

      body {
        margin: 0;
        background: #f9f9f9;
        background: #fff;
        color: #666;
        font-family: 'Abel', Helvetica, Arial;
        line-height: 1.6;
      }
      a {
        text-decoration: none;
        color: #000000;
      }
      a:hover {
        color: #ED1C24;
        text-decoration: none;
      }
      input {
        font-family: 'Abel', Helvetica, Arial;
      }
      table {
        margin-left: auto;
        margin-right: auto;
      }
      table td,
      table th {
        vertical-align: middle;
      }

      .center {
        text-align: center;
      }

      #info-box {
        position: absolute;
        z-index: 100;
        bottom: 10px;
        left: 0;
        right: 0;

        bottom: 60px;
        left: 50%;
        width: 400px;
        margin-left: -200px;

        bottom: auto !important;
        top: 68% !important;
      }

      header {
        position: absolute;
        z-index: 100;
        top: 0;
        left: 0;
        right: 0;
        height: 150px;
        overflow: hidden;

        background-image: url('../public/images/header-bg.png');
        background-repeat: repeat-x;
        background-position: 0 -20px;
      }
      .ui {
      /*
        position: absolute;
        z-index: 100;
        bottom: 10px;
        left: 0;
        right: 0;
        */
        position: absolute;
        z-index: 100;
        top: 10px;
        right: 10px;
        width: 250px;

        top: 0;
        left: 400px;
        right: auto;
        width: 560px;
      }
      .ui h1,
      .ui #form-search {
        /*text-align: center;*/
        float: left;
      }
      .ie8 .ui #form-search,
      .ie9 .ui #form-search {
        padding-top: 13px;
      }
      .ui .spinner {
        display: inline-block;
        position: absolute;
        margin: 15px 10px 0;
        width: 32px;
        height: 32px;
        background: url('/public/images/loader.gif');
      }
      .ui .spinner.hidden {
        visibility: hidden;
      }

      #form-search {
        display: inline-block;
        vertical-align: top;
        margin-top: 10px;
      }

      #form-search [type="submit"] {
        display: inline-block;
        width: 60px;
        height: 35px;
        margin: 10px 0 0;
        border: none;
        background: #000;
        vertical-align: top;
        color: #fff;
        font-family: 'Abel', Helvetica, Arial;
        font-size: 18px;
      }
      h1 {
        position: absolute;
        z-index: 100;
        margin: 20px 0 10px;
        color: #000;
      }
      h1 .title {
        display: inline-block;
        vertical-align: middle;
        margin-left: 20px;
        margin-top: -2px;
        font-weight: normal;
        font-size: 28px;
      }
      h1 .title .logo {
        display: inline-block;
        float: left;
        width: 30px;
        height: 30px;
        background-repeat: repeat;
        background-image: url('/public/images/logo@2x.png');
        background-image: url('/public/images/logo.png')\9;
        background-repeat: no-repeat;
        background-size: cover;
        vertical-align: middle;
        margin-right: 5px;
        margin-top: 5px;
      }
      .ie8 h1 .title .logo,
      .ie9 h1 .title .logo {
        display: inline;
      }
      .ie9 h1 .title .logo {
        margin-top: 0;
      }
      h1 a.logo {
        display: inline-block;
        float: left;
        width: 191px;
        height: 36px;
        background: url('/public/images/gettyimages.gif') no-repeat;
        background-size: cover;
        background-repeat: no-repeat;
        vertical-align: middle;
      }
      h2 {
        font-size: 24px;
        color: #000;
        margin: 20px 0;
      }
      ul {
        padding: 0;
      }
      input[name='query'] {
        font-size: 18px;
        line-height: 36px
        /*border-radius: 10px;*/
        background: #f6f6f6;
        border: 1px solid #eee;
        padding: 5px 5px;
        outline: none;
        margin: 10px 0 0;
        -webkit-appearance: none;
      }
      input[name='query']:focus {
        background: white;
        border: 1px solid #ccc;
      }
      .toggle-year-range {
        display: none;
      }
      .status {
        position: absolute;
        z-index: 100;
        left: 855px;
        top: 25px;
        width: 160px;
        margin-top: 0;
        margin-bottom: 0;
        margin-left: 0;
      }
      .ie8 .status,
      .ie9 .status {
        left: 755px;
      }
      .social-header {
        position: absolute;
        width: 150px;

        z-index: 100;

        right: 10px;
        top: 25px;
      }
      .status .spinner {
        margin-left: 10px;
      }
      .loading-text.hidden,
      .result-text.hidden {
        display: none;
      }
      .loading-text {
        float: left;
        margin-left: 24px;
      }
      .result-text {
        /*text-align: right;*/
        float: left;
        margin-left: 30px;
      }
      .result-text .count {
        color: #ED1C24;
        padding-right: 4px;
      }
      #stage {
        position: absolute;
        top: 30px;
      }
      /*
      #info-box {
        position: absolute;
        top: 10px;
        right: 10px;
        width: 250px;
      }
      */
      #info-box.hidden {
        display: none;
      }
      #info-box h3 {
        font-weight: normal;
        line-height: 1.2;
        margin: 0;
        color: #000;
      }
      #info-box .artist {
        color: #ED1C24;
        margin: 0 0 5px;
        font-size: 13px;
      }
      #info-box p {
        margin: 0 0 10px;
        font-size: 13px;
      }
      #info-box .more {
        color: #000;
        font-size: 12px;
      }
      #year-range-slider {
        width: 30%;
        font-size: 13px;

        width: 80%;
        margin-top: 25px;
      }

      .ui-slider .ui-slider-handle{
        cursor: default;
        height: 1.2em;
        position: absolute;
        width: 1.2em;
        z-index: 2;
      }
      #year-range {
        display: inline-block;
        width: 200px;
        vertical-align: top;
        margin-top: 15px;
        padding-left: 10px;
        position: relative;
      }
      #year-range-label{
        position: absolute;
        top: 0;
        left: 20px;
        font-size: 14px;
        color: #333;
        margin: 0;
        position: absolute;
        top: 0;
        left: 20px;
      }
      #year-range-text{
        font-size: 14px;
        color: #ED1C24;
        margin: 10px 0 5px;
        margin: 0;
        position: absolute;
        top: 0;
        left: 60px;
      }
      #year-range-from,
      #year-range-to {
        font-size: 14px;
        color: #ED1C24;
      }
      #year-range-from {
        position: absolute;
        top: 0;
        left: 80px;
      }
      #year-range-from {
        position: absolute;
        top: 0;
        right: 80px;
      }
      .profile-list li {
        list-style: none;
        clear: both;
      }
      .profile-main {
        float: left;
        width: 500px;
      }
      .profile-pic {
        display: block;
        float: left;
        width: 60px;
        height: 60px;
        margin-right: 20px;
        border-radius: 60px;
        overflow: hidden;

        background-repeat: no-repeat;
        background-size: cover;
      }
      .profile-pic-theeraphol {
        background-image: url('../public/images/profile-theeraphol.png');
      }
      .profile-pic-rapee {
        background-image: url('../public/images/profile-rapee.png');
      }
      .profile-pic-thiti {
        background-image: url('../public/images/profile-thiti.png');
      }
      .profile-pic-yoonjo {
        background-image: url('../public/images/profile-yoonjo.png');
      }
      .footer {
        font-size: 13px;
        color: #000;
        position: absolute;
        z-index: 100;
        bottom: 20px;
        left: 30px;

        bottom: 0;
        left: 0;
        right: 0;
        padding: 5px 20px;
        background: #333;
        color: #ccc;
        width: 100%;
        text-align: center;
      }
      .footer a {
        margin-right: 15px;
        color: #ccc;
        vertical-align: middle;
      }
      .footer a:hover {
        color: #ED1C24;
      }
      a.connect-logo {
        display: inline-block;
        width: 80px;
        height: 24px;
        margin-left: 20px;
        background-image: url("../public/images/connect-logo.png");
        background-repeat: no-repeat;
        background-size: cover;
        background-position: -80px 0;
      }
      a.connect-logo:hover {
        background-position: 0 0;
      }

      #lean_overlay {
        position: fixed;
        z-index:9999;
        top: 0px;
        left: 0px;
        height:100%;
        width:100%;
        background: #000;
        display: none;
      }
      .modal{
        display: none;
        position: absolute !important;
        padding: 5px 60px 40px;
        box-sizing: border-box;
        font-size: 15px;
        background: #FFF;
        border-radius: 5px; -moz-border-radius: 5px; -webkit-border-radius: 5px;
        box-shadow: 0px 0px 4px rgba(0,0,0,0.7); -webkit-box-shadow: 0 0 4px rgba(0,0,0,0.7); -moz-box-shadow: 0 0px 4px rgba(0,0,0,0.7);
      }
      .modal p {
        margin: 0 0 10px;
      }
      .modal li {
        margin-bottom: 5px;

      }
      .modal h3 {
        color: #000;
        font-size: 16px;
        margin: 0 0 3px;
      }
      #aboutusModal{
        width: 700px;
      }
      #tourModal{
        width: 700px;
      }
      #controlGuideLeft {
        float:left;
        width:46%;
      }
      #controlGuideRight {
        float: left;
        width: 46%;
      }

      #controller {
        position: absolute;
        z-index: 101;
        top: 150px;
        left: 50%;
        margin-left: 350px;
        -webkit-transition: all 1s ease-in-out;
           -moz-transition: all 1s ease-in-out;
            -ms-transition: all 1s ease-in-out;
                transition: all 1s ease-in-out;
      }

      #controller.hidden {
        opacity: 0;
      }

      #controller a {
        display: block;
        width: 50px;
        cursor: pointer;
        opacity: .5;
        margin-bottom: 25px;
      }
      #controller a:hover {
        opacity: 1;
      }
      @media only screen and (max-width: 1155px){
        .social-header{
          top: 70px;
          left: 25px;
        }
      }
      @media only screen and (max-width: 1024px) and (min-width: 480px) {
        .social-header{
          top: 70px;
          left: 25px;
        }
        .status {
          top: 70px;
          left: auto;
          right: 10px;
        }
      }

      @media only screen and (max-width: 850px) and (min-width: 480px) {
        .footer {
          display: none;
        }

        h1 {
          position: absolute;
          top: 0;
          left: 0;
          margin-top: 25px;
        }
        h1 .logo {
          width: 96px;
          height: 18px;
          float: left;
        }
        h1 .title {
          font-size: 18px;
        }
        h1 .title .logo {
          width: 15px;
          height: 15px;
        }
        .ui {
          left: auto;
          right: 20px;
          width: 450px;
        }

        #controller {
          margin-left: 0;
          left: auto;
          right: 30px;
        }
        #info-box {
          bottom: 20px;
        }
      }

      @media only screen and (max-width: 480px) {
        .footer {
          display: none;
        }
        .status {
          top: 50px;
          left: 50%;
        }
        .social-header {
          top: 50px;
          left: 5%;
        }
        h1 {
          display: none;
          position: absolute;
          top: 0;
          left: 0;
        }
        h1 .logo { display: none; }
        h1 .title {
          font-size: 18px;
        }
        h1 .title .logo {
          width: 15px;
          height: 15px;
        }
        .ui {
          width: 100%;
          position: static;
          text-align: center;
        }
        .ui #form-search {
          position: absolute;
          left: 0;
          margin: 0;

          text-align: left;
          width: 90%;
          left: 5%;
        }
        #form-search [type="search"] {
          width: 70%;
        }

        .toggle-year-range {
          display: inline-block;
          width: 35px;
          height: 35px;
          position: absolute;
          top: 10px;
          right: 0;
          background-image: url('/public/images/keyboard-down.png');
          background-size: cover;
        }
        .option-active .toggle-year-range {
          background-image: url('/public/images/keyboard-up.png');
        }

        #year-range {
          display: none;
        }
        .option-active #year-range {
          display: block;
          position: absolute;
          z-index: 200;
          top: 50px;
          right: 0;
          left: 0;

          width: 100%;

          margin-top: 0;
          padding-left: 0;
          padding-top: 10px;
          padding-bottom: 20px;
          background: white;
          border-bottom: 1px solid #ddd;
        }
        #year-range-slider {
          margin-left: auto;
          margin-right: auto;
        }
        #year-range-label {
          left: 10%;
          top: 10px;
        }
        #year-range-text {
          left: 20%;
          top: 10px;
        }
        #controller {
          margin-left: 0;
          left: auto;
          right: 10px;
          bottom: 0;
          top: auto;
        }
      }
      @media only screen and (max-width: 350px) {
        #form-search {
          width: 96%;
          left: 2%;
        }
        #form-search [type="search"] {
          width: 60%;
        }
      }


      @media only screen and (max-height: 720px) and (min-width: 640px) {

        #info-box {
          width: 600px;
          margin-left: -300px;
        }

      }
      @media only screen and (max-height: 600px) and (min-width: 640px) {

        #info-box {
          width: 800px;
          margin-left: -400px;
        }
        .footer {
          display: none;
        }
      }

      @media only screen and (max-height: 600px) and (max-width: 840px), only screen and (max-width: 480px) {

        #info-box {
          margin-left: 0;
          left: 20px;
          right: 20px;
          width: auto;
          height: 110px;
          bottom: 10px;
          overflow: auto;
        }
        #info-box h3 {
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
          width: 100%;
        }

      }
      @media only screen and (max-height: 400px) {

        #info-box {
          height: 100px;
        }
      }

      .no-webgl #stage {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        overflow: hidden;
      }
      .no-webgl #stage .container {
        position: relative;
        width: 100%;
        height: 100%;
      }
      .ie8.no-webgl #stage ,
      .ie9.no-webgl #stage {
        position: static;
      }
      .ie8.no-webgl #stage .container,
      .ie9.no-webgl #stage .container {
        position: static;
      }
      .no-webgl .tt-item {
        position: absolute;
        left: 50%;
      }
      .no-webgl .tt-item.textmarker {
        font-size: 50px;
        color: #333;
        border-bottom: 6px solid #ED1C24;
        padding: 0 10px;
      }
      .no-webgl #info-box {
        bottom: auto !important;
        top: 68% !important;
      }

  body
    #fb-root
    script.
      window.fbAsyncInit = function() {
        FB.init({
          appId      : '738154599580860',
          xfbml      : true,
          version    : 'v2.0'
        });
      };

      (function(d, s, id){
         var js, fjs = d.getElementsByTagName(s)[0];
         if (d.getElementById(id)) {return;}
         js = d.createElement(s); js.id = id;
         js.src = "//connect.facebook.net/en_US/sdk.js";
         fjs.parentNode.insertBefore(js, fjs);
       }(document, 'script', 'facebook-jssdk'));

    header
      h1
        a.logo(href='http://gettyimages.jp', target='_blank')
        .title
          .logo
          | Time Travel
      .ui
        form(id='form-search')
          input(type='search', placeholder='e.x. コンピューター', value='コンピューター', name='query')
          button(type='submit') Go
          a.toggle-year-range(href='#')
          //- .spinner.hidden
          input(type='hidden', name='itemperpage', value='20')
          input(type='hidden',id='startdate',name='startdate')
          input(type='hidden',id='enddate',name='enddate')
          input(type='hidden', name='sortby', value='MostPopular')
        #year-range
          #year-range-slider
          #year-range-label Year
          #year-range-text
      .status
        .loading-text Loading...
        .result-text <span class='count'></span> photos found
      .social-header
        .fb-like(data-href="http://timetravel-gettyimages.jp", data-layout="button_count", data-action="like", data-show-faces="true", data-share="true")

    .footer
      a(href="#tourModal", rel="leanModal") Take a Tour
      a(href="#aboutusModal", rel="leanModal") About the Creator
      //- a(href="https://github.com/boonmeelab/timetravel", target="_black") Github
      a(href="http://www.photohackday.org", target="_black") 1<sup>st</sup> prize from Photo Hack Day 5
      a.connect-logo(href="http://api.gettyimages.com/", target="_black", alt="Powered by Connect API")

    #controller.hidden
      a.next-btn(title="Arrow Up")
        img(src="/public/images/keyboard-up.png")
      a.prev-btn(title="Arrow Down")
        img(src="/public/images/keyboard-down.png")
    #stage

    #info-box.hidden
      h3
      .artist
      p
      //- .keyword
      a.more(target='_blank') Show Original

    #tourModal.modal
      div
        .center
          h2 Guideline
          p Welcome to Time Travel &mdash; a time machine on the Internet!
        p Time Travel will take you to explore the world of history related to your interesting topics.
        p Try to search what you want to know and also specify the range of years you want to go through a time space.
        p You can control our time travel by using a keyboard or leap motion if you have one. <br>So, just plug it in to your computer and you are ready to go!
        br
        #controlGuideLeft
          .center
            h3 Keyboard
            table
              tr
                td
                  img(src="/public/images/keyboard-up.png", style="margin: 5px 10px;")
                td Forward
              tr
                td
                  img(src="/public/images/keyboard-down.png", style="margin: 5px 10px;")
                td Backward
        #controlGuideRight
          .center
            h3 Leap Motion
            table
              tr
                td
                  img(src="/public/images/LM_clockwise.png", height="50px", width="50px")
                td(width="30px")
                td
                  img(src="/public/images/LM_counterclockwise.png", height="50px", width="50px")
              tr
                td Forward
                td &nbsp;
                td Backward
            <br>
            img(src="/public/images/LM_handwalk.png", height="50px", width="100px")
            div Walk through time!
    #aboutusModal.modal
      div
        .center
          h2 About the Creator
        ul.profile-list
          li
            .profile-pic.profile-pic-theeraphol
            .profile-main
              h3 <a href='http://www.parnurzeal.com', target='_blank'>Theeraphol Wattanavekin</a>, Developer
              p An infrastructure developer working in Rakuten, Inc. in Japan who interests in various fields such as web technology, big data, image processing and robotics.

          li
            .profile-pic.profile-pic-rapee
            .profile-main
              h3 <a href='http://www.linkedin.com/in/rapee', target='_blank'>Rapee Suveeranont</a>, Developer
              p Full-stack developer with wide range of skills in game, interactive, web and mobile application. He also draws, runs and travels.

          li
            .profile-pic.profile-pic-yoonjo
            .profile-main
              h3 <a href='https://www.linkedin.com/in/yoonjoshin', taget='_blank'>Shin Yoonjo</a>, Designer
              p Web director specialized in UX. Yoonjo studied and worked in 4 different countries. She is also an armature dancer and violinist.

          li
            .profile-pic.profile-pic-thiti
            .profile-main
              h3 <a href='http://thitiphong.com', target='_blank'>Thiti Luang</a>, Designer
              p An experience designer who makes things he loves for people he likes.


    //- Application scripts
    //- script(src="/public/js/search.js")
    script(src="/public/js/render.js")
    //if gt IE 8
    script(src="/public/js/leap.js")
    //<![endif]
    //- script(src="/public/js/render.js")

    script.
      var currentInfoBoxId;
      function updateInfoBox(params) {
        var $box = $('#info-box');
        if (params.id != currentInfoBoxId) {
          currentInfoBoxId = params.id;
          var url = 'http://www.gettyimages.co.jp/detail/'+params.id+'?referer=timetravel';
          if (typeof params.show === 'boolean') $box[ params.show ? 'removeClass' : 'addClass']('hidden');
          if (params.title) $box.find('h3').empty().append($('<a target="_blank">').attr('href', url).text(params.title)); // Title
          if (params.artist) $box.find('.artist').text(params.artist); // Artist
          if (params.caption) {
            $box.find('p').text(params.caption.slice(0, 500) + (params.caption.length > 500 ? '...' : '')); // Caption
          }
          $box.find('.more').attr('href', url); // Link
        }
      }


